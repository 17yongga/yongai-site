---
// Contact Form component with Formspree integration
---

<div class="glassmorphism rounded-3xl p-12 max-w-4xl mx-auto relative overflow-hidden">
  <!-- Glow effect -->
  <div class="absolute -top-24 left-1/2 transform -translate-x-1/2 w-96 h-96 bg-yong-green/10 rounded-full filter blur-3xl pointer-events-none"></div>
  
  <div class="relative z-10 text-center">
    <div class="inline-block px-4 py-2 bg-yong-green/10 text-yong-green text-sm font-mono font-semibold rounded-full mb-6">
      Ready to Start?
    </div>
    
    <h2 class="text-3xl lg:text-4xl font-bold mb-4">
      Let's find what AI can actually do for you.
    </h2>
    
    <p class="text-lg text-text-muted mb-10 max-w-2xl mx-auto">
      Book a free 30-minute strategy call. No pitch, no pressure — just an honest assessment of where automation fits in your business.
    </p>
    
    <form class="space-y-6" id="contactForm" action="https://formspree.io/f/xwvnkpak" method="POST">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <input 
            type="text" 
            name="name" 
            placeholder="Your name"
            required
            class="w-full px-6 py-4 bg-bg-raised border border-border-light rounded-xl text-text-primary placeholder:text-text-faint focus:border-yong-green focus:ring-2 focus:ring-yong-green/20 focus:outline-none transition-all duration-300"
          />
        </div>
        <div>
          <input 
            type="email" 
            name="email" 
            placeholder="Work email"
            required
            class="w-full px-6 py-4 bg-bg-raised border border-border-light rounded-xl text-text-primary placeholder:text-text-faint focus:border-yong-green focus:ring-2 focus:ring-yong-green/20 focus:outline-none transition-all duration-300"
          />
        </div>
      </div>
      
      <div>
        <input 
          type="text" 
          name="company" 
          placeholder="Company name"
          class="w-full px-6 py-4 bg-bg-raised border border-border-light rounded-xl text-text-primary placeholder:text-text-faint focus:border-yong-green focus:ring-2 focus:ring-yong-green/20 focus:outline-none transition-all duration-300"
        />
      </div>
      
      <div>
        <select 
          name="interest" 
          required
          class="w-full px-6 py-4 bg-bg-raised border border-border-light rounded-xl text-text-primary focus:border-yong-green focus:ring-2 focus:ring-yong-green/20 focus:outline-none transition-all duration-300"
        >
          <option value="" disabled selected>What are you interested in?</option>
          <option value="audit">AI Readiness Audit — $2,500</option>
          <option value="implementation">AI Implementation — $5K–$15K</option>
          <option value="partnership">AI Partnership — $2K–$5K/mo</option>
          <option value="unsure">Not sure yet — let's talk</option>
        </select>
      </div>
      
      <div>
        <textarea 
          name="message" 
          rows="4" 
          placeholder="Tell me about your biggest workflow bottleneck (optional)"
          class="w-full px-6 py-4 bg-bg-raised border border-border-light rounded-xl text-text-primary placeholder:text-text-faint focus:border-yong-green focus:ring-2 focus:ring-yong-green/20 focus:outline-none transition-all duration-300 resize-vertical"
        ></textarea>
      </div>
      
      <button 
        type="submit" 
        class="w-full bg-gradient-to-r from-yong-green to-yong-green-light text-white px-8 py-5 rounded-xl font-bold text-lg transition-all duration-300 hover:scale-[1.02] hover:shadow-xl hover:shadow-yong-green/25 btn-animate inline-flex items-center justify-center gap-3"
        id="submitBtn"
      >
        <span id="submitText">Book My Free Strategy Call</span>
        <svg id="submitIcon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="5" y1="12" x2="19" y2="12"></line>
          <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
        <div id="submitSpinner" class="hidden w-6 h-6 border-2 border-white/20 border-t-white rounded-full animate-spin"></div>
      </button>
      
      <div class="text-center space-y-2">
        <p class="text-sm text-text-faint">
          Free 30-minute call · No commitment · Response within 24 hours
        </p>
        <p class="text-sm text-text-faint">
          Or email directly: <a href="mailto:gary.yong@yongai.ca" class="text-yong-green hover:text-yong-green-light transition-colors duration-200">gary.yong@yongai.ca</a>
        </p>
      </div>
    </form>
  </div>
  
  <!-- Success message (hidden by default) -->
  <div id="successMessage" class="hidden text-center py-12">
    <div class="w-20 h-20 mx-auto mb-6 bg-success/10 rounded-full flex items-center justify-center">
      <svg class="w-10 h-10 text-success" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
      </svg>
    </div>
    <h3 class="text-2xl font-bold mb-4">Thank you!</h3>
    <p class="text-lg text-text-muted mb-6">
      Your message has been sent successfully. I'll get back to you within 24 hours.
    </p>
    <button 
      onclick="resetForm()" 
      class="text-yong-green hover:text-yong-green-light transition-colors duration-200 font-medium"
    >
      Send another message
    </button>
  </div>
</div>

<script>
  function initContactForm() {
    const form = document.getElementById('contactForm');
    const submitBtn = document.getElementById('submitBtn');
    const submitText = document.getElementById('submitText');
    const submitIcon = document.getElementById('submitIcon');
    const submitSpinner = document.getElementById('submitSpinner');
    const successMessage = document.getElementById('successMessage');
    
    if (!form || !submitBtn) return;
    
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      // Show loading state
      submitBtn.disabled = true;
      submitText.textContent = 'Sending...';
      submitIcon.classList.add('hidden');
      submitSpinner.classList.remove('hidden');
      
      try {
        const formData = new FormData(form);
        const response = await fetch(form.action, {
          method: 'POST',
          body: formData,
          headers: {
            'Accept': 'application/json'
          }
        });
        
        if (response.ok) {
          // Show success message
          form.style.display = 'none';
          successMessage.classList.remove('hidden');
        } else {
          throw new Error('Form submission failed');
        }
      } catch (error) {
        console.error('Error:', error);
        alert('There was an error sending your message. Please try again or email gary.yong@yongai.ca directly.');
        
        // Reset button state
        submitBtn.disabled = false;
        submitText.textContent = 'Book My Free Strategy Call';
        submitIcon.classList.remove('hidden');
        submitSpinner.classList.add('hidden');
      }
    });
  }
  
  function resetForm() {
    const form = document.getElementById('contactForm');
    const submitBtn = document.getElementById('submitBtn');
    const submitText = document.getElementById('submitText');
    const submitIcon = document.getElementById('submitIcon');
    const submitSpinner = document.getElementById('submitSpinner');
    const successMessage = document.getElementById('successMessage');
    
    // Reset form
    form.reset();
    form.style.display = 'block';
    successMessage.classList.add('hidden');
    
    // Reset button state
    submitBtn.disabled = false;
    submitText.textContent = 'Book My Free Strategy Call';
    submitIcon.classList.remove('hidden');
    submitSpinner.classList.add('hidden');
  }
  
  // Initialize form
  document.addEventListener('DOMContentLoaded', initContactForm);
  
  // Reinitialize on navigation
  document.addEventListener('astro:page-load', initContactForm);
</script>